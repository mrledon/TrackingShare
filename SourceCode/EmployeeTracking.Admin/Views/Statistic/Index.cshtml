@model  List<EmployeeTracking.Data.ModelCustom.StatisticNumberStoreDay>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .axias path, .axias line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
    }

    .x.axias path {
        display: none;
    }

    #mapLoad {
    }

    .iframe {
        width: 100%;
    }

    .gmap_canvas {
        width: 100% !important;
    }

    .mapouter {
        width: 100% !important;
    }

    .form-control {
        border-radius: 5px;
    }

    .sltProvince {
        text-decoration: none;
        color: black;
    }

    .sltProvince {
        text-decoration: none;
    }

        .sltProvince:hover {
            text-decoration: underline;
            color: cadetblue;
            cursor: pointer;
        }

    .lstProvince {
        padding: 3px;
        background-color: antiquewhite;
        border-bottom: 0.15px solid blue;
        margin-top: 1px;
    }

    .lstProvince {
        padding: 3px;
        background-color: #F4F4F4;
        border-bottom: 0.15px solid blue;
        margin-top: 1px;
        color: black;
    }
</style>
<style>

    #carousel-custom {
        margin: 10px auto;
        width: 400px;
    }

        #carousel-custom .carousel-indicators {
            margin: 10px 0 0;
            overflow: auto;
            position: static;
            text-align: left;
            white-space: nowrap;
            width: 100%;
        }

            #carousel-custom .carousel-indicators li {
                background-color: transparent;
                -webkit-border-radius: 0;
                border-radius: 0;
                display: inline-block;
                height: auto;
                margin: 0 !important;
                width: auto;
            }

                #carousel-custom .carousel-indicators li img {
                    display: block;
                    opacity: 0.5;
                    height: 50px;
                }

                #carousel-custom .carousel-indicators li.active img {
                    opacity: 1;
                }

                #carousel-custom .carousel-indicators li:hover img {
                    opacity: 0.75;
                }

        #carousel-custom .carousel-outer {
            position: relative;
        }
</style>


@*chia lam 3 phan view: 1. Statistic chart, 2. phan google maps &Aacute; selections, 3. popupDetail*@
@*=============================== Day la phan chart ========================*@
<div class="">
    <h2>Thống kê doanh thu</h2>
    <button class="btn btn-danger" data-toggle="modal" data-target="#myModalDetail">
        Show modal
    </button>
</div>
<div class="row">
    <div class="col-md-12" style="display:flex;justify-content:center;">
        <div id="chartLoad" style="
    padding: 5px;
    border: 1px solid #2519d2f7;
    border-radius: 9px;
    width: 80%;
    display: flex;
    height: 300px;
    justify-content: center;
">

        </div>
    </div>
</div>
@*=============================== Het phan chart ========================*@
<div class="row" style="margin-top:75px;">
    <div class="col-md-12">
        <div class="col-md-8">
            <div id="map" style="position: relative;overflow: hidden;height: 100%;min-height: 500px;"></div>
        </div>
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="col-md-4 form-group">
                        <select style="width:100%;"
                                id="provinceVietNam"
                                class="provinceVietNam1 form-control">
                            <option value="0" selected>
                                Toàn quốc
                            </option>
                            <option value="1">
                                Hồ Chí Minh
                            </option>
                            <option value="2">
                                Hà Nội
                            </option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select style="width:100%;" class="districtVietNam form-control">
                            <option value="0">
                                Quận/huyện
                            </option>
                            <option value="1">
                                Quận 2
                            </option>
                            <option value="2">
                                Quận 3
                            </option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select style="width:100%;" class="wardVietNam form-control">
                            <option value="0">
                                Phường 1
                            </option>
                            <option value="1">
                                Phường 2
                            </option>
                            <option value="2">
                                Phường 3
                            </option>
                        </select>
                    </div>
                    <div class="col-md-12">
                        <ul style="width:100%;height:250px;overflow-y:scroll;list-style-type:none;padding:0;">
                            <li class="lstProvince">
                                <a title="TP.Hồ Chí Minh" class="sltProvince">
                                    Tp.Hồ Chí Minh<i class="">(106)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                            <li class="lstProvince">
                                <a title="An Giang" class="sltProvince">
                                    An Giang<i class="">(11)</i>
                                </a>
                            </li>
                        </ul>
                    </div>

                    <div class="col-md-12">
                        <div>
                            <table style="width:100%" class="table table-bordered table-hover table-striped">
                                <thead>
                                    <tr>
                                        <th>
                                            Cửa hàng
                                        </th>

                                    </tr>
                                </thead>
                                <tbody id="lstStore">
                                    <tr>
                                        <td>
                                            Q1: 39 Lý Tự Trọng, Bến Nghé, Quận 1, Hồ Chí Minh, Việt Nam
                                        </td>

                                    </tr>
                                    <tr>
                                        <td>
                                            Q2: 33 Lý Tự Trọng, Bến Nghé, Quận 2, Hồ Chí Minh, Việt Nam
                                        </td>

                                    </tr>
                                    <tr>
                                        <td>
                                            Q1: : 22 Lý Tự Trọng, Bến Nghé, Quận 1, Hồ Chí Minh, Việt Nam
                                        </td>

                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    #carousel-custom {
        margin: 0 !important;
        width: 71%;
    }
</style>

<div id="myModalDetail" class="modal fade" role="dialog" data-stored="">
    <div class="modal-dialog" style="width:80%;">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Thông tin cửa hàng</h4>
            </div>
            <div class="modal-body">

            </div>

            <div class="modal-footer" style="border: none;">
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

@*=============================== Day la phan xu ly javascriipt========================*@

<!--Chart-->

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
    //google.charts.load('current', { 'packages': ['bar'] })
    google.charts.load('current', { packages: ['corechart', 'bar'] });
    google.charts.setOnLoadCallback(drawColColors);
    function drawColColors() {
        
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Báo cáo');
        data.addColumn('number', 'Thành công');
        data.addColumn('number', 'Không thành công');
        data.addColumn('number', 'Chưa submit');

        function loadDataSummaryChart(callback) {
            $.ajax({
                url: 'http://localhost:60312/Statistic/ShowFiveDayChart',
                type: 'POST',
                cache: false,
                async: true,
                xhrFields: {
                    withCredentials: true,
                },
                dataType: 'json',
                success: function (response) {
                    $.each(response, function (idx, item) {
                        data.addRow([item.Categorie, item.Success, item.Fail, item.UnSubmit]);
                    });
                    callback();
                },
                error: function (xhr, status, error) {
                }
            });
        }

        var options = {
            legend: { position: 'bottom' },
            title: '',
            titlePosition: 'out',
            hAxis: {
                title: ''
            },
            vAxis: {
                title: '',
                format: 'short',
                gridlines: { count: 5 },
                scareType: 'mirrorLog'
            },
            series: {
                0: {
                    color: '2ECC40'
                },
                1: {
                    color: 'AAAAAA'
                },
                2: {
                    color: 'FFDC00'
                }
            },
            //Makes the entire category's tooltip active
            focusTarget: 'category',
            //Use a html tooltip
            tooltip: { isHtml: true },
            asex: {

            },
            pointSize: 5,
            backgroundColor: 'none'
        };

        function drawChart() {
            var chart = new google.visualization.ColumnChart(document.getElementById('chartLoad'));
            chart.draw(data, options);
        }

        loadDataSummaryChart(drawChart);

        if (document.addEventListener) {
            window.addEventListener('resize', drawChart);
        }
        else if (document.attachEvent) {
            window.attachEvent('onresize', drawChart);
        }
        else {
            window.resize = drawChart;
        }
    }

</script>


<script>
    var data = [
        {
            id: 0,
            text: 'Toàn Quốc'
        },
        {
            id: 1,
            text: 'Hồ Chí Minh'
        },
        {
            id: 2,
            text: 'Hà Nội'
        },
        {
            id: 3,
            text: 'Bình Định'
        },
        {
            id: 4,
            text: 'Huế'
        }
    ];

    var district = [
        {
            id: 0,
            text: 'Quận Gò Vấp'
        },
        {
            id: 1,
            text: 'Quận 2'
        },
        {
            id: 2,
            text: 'Quận 1'
        },
        {
            id: 3,
            text: 'Quận 3'
        },
        {
            id: 4,
            text: 'Quận 4'
        }
    ]

    var ward = [
        {
            id: 0,
            text: 'Phường 1'
        },
        {
            id: 1,
            text: 'Phường 2'
        },
        {
            id: 2,
            text: 'Phường 3'
        },
        {
            id: 3,
            text: 'Phường 4'
        },
        {
            id: 4,
            text: 'Phường 5'
        }
	]

	window.onload = () => {
		//Step 1: Load vào tỉnh/thành phố
		$.ajax({
			url: '@Url.Action("GetProvinceSelect", "Location")',
			type: "GET",
			success: function(data) {
				var s = '<option value=' + 0 + '>' + 'Toàn quốc' + '<option>';
				for (var i = 0; i < data.length; i++) {

					s = s + '<option value=' + data[i].Id + '>' + data[i].Name + '<option>';
				}
				$('.provinceVietNam1').html(s);
			}
		});
    }

	$(document).ready(function () {

		//Step 2: Bẫy sự kiện onchange cho tỉnh/thành phố
		$("#provinceVietNam").on("change", function () {
			var id = $("#provinceVietNam option:selected").val();
			if (id === "0") {
                $(".districtVietNam").hide();
                $(".wardVietNam").hide();
            } else {
				$(".districtVietNam").show();
                $(".wardVietNam").show();


				//Step 3: Nếu có 1 tỉnh/thành phố được chọn bởi người dùng
				$.ajax({
                    url: '@Url.Action("GetDistrictSelect", "Location")',
                    type: "GET",
					data: {'provinceId': id},
					success: function (data) {
						//Step 4: Load dữ liệu cho quận/huyện theo tỉnh đã chọn ở trên
                        var s = '';
						for(var i=0; i<data.length; i++) {
							s = s + '<option value=' + data[i].Id + '>'+ data[i].Name +  '<option>';
						}
						$('.districtVietNam').html(s);
                    }
				});
			}

		});

		//Step 5: Bẫy sự kiện onchange cho quận/huyện
        $(".districtVietNam").on("change", function () {
	        debugger;
			var id = $(".districtVietNam option:selected").val();

			if (id === "0") {
                $(".wardVietNam").hide();
            } else {
				$(".wardVietNam").show();

				//Step 6: Nếu có 1 quận/huyện được chọn bởi người dùng
				$.ajax({
                    url: '@Url.Action("GetWardSelect", "Location")',
                    type: "GET",
					data: {'districtId': id},
					success: function (data) {
						//Step 7: Load dữ liệu của phường/xã theo {tỉnh/thành phố + quận/huyện} ở trên
                        var s = '';
						for(var i=0; i<data.length; i++) {
							s = s + '<option value=' + data[i].Id + '>'+ data[i].Name +  '<option>';
						}
						$('.wardVietNam').html(s);
                    }
				});
            }
        });
	});

</script>


<script>

    function initMap() {
        var uluru = { lat: 10.8222049, lng: 106.6853089 };
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 10,
            center: uluru
        });

        var contentString = '';

        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        var marker = new google.maps.Marker({
            position: uluru,
            map: map,
            title: 'Uluru (Ayers Rock)'
                        });
        marker.addListener('click', function () {
            infowindow.open(map, marker);
            var url = '@Url.Action("GetDetail", "Statistic")' + "?id=" + marker;
            $("#myModalDetail").modal('show');
        });
    }
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAYRnRViXs8s0PTUKdR78s0tS_OeZqcC64&libraries=places&callback=initMap&language=vi&region=VI"></script>

